# v4-core completion benchmark
#
# Tests scope-aware dot-completion on real Uniswap v4-core code.
#
# Position: Pool.sol line 207, col 32 — `self.slot0`
#   The `self` parameter is a `Pool.State storage` struct. Scope-aware
#   resolution must find `self` in the FunctionDefinition scope (Pool.swap)
#   and resolve it to t_struct$_State_$4809_storage_ptr to show struct fields
#   (slot0, liquidity, feeGrowthGlobal0X128, ticks, tickBitmap, positions).
#
# v0.1.14: has scope-aware mode but Block parent linkage is broken —
#          scope walk stops at Block, falls back to flat first-wins lookup.
# v0.1.15: Block parent inference fixed — scope walk correctly traverses
#          Block → FunctionDefinition → ContractDefinition → SourceUnit.

project: /Users/meek/developer/uniswap/v4-core
file: src/libraries/Pool.sol
# Line 206 (0-based) = `Slot0 _slot0 = self.slot0;`
# Col 32 = right after the dot in `self.`
line: 206
col: 32

iterations: 10
warmup: 2
timeout: 10
index_timeout: 15
response: full
trigger_character: "."
output: benchmarks/v4-core
report: benchmarks/v4-core/COMPLETION.md

benchmarks:
  - initialize
  - textDocument/completion

servers:
  - label: v0.1.14-full
    description: v0.1.14 --completion-mode full (broken Block parent linkage)
    cmd: solidity-language-server
    args: ["--completion-mode", "full"]

  - label: v0.1.15-full
    description: v0.1.15 --completion-mode full (scope-aware with Block fix)
    cmd: ./target/release/solidity-language-server
    args: ["--completion-mode", "full"]
