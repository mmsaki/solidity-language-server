# Neovim

Example from your real setup in `~/.config/nvim/lsp`.

For the full settings schema, see [Setup Overview](/setup).

Server config:

```lua [.config/nvim/lsp/solidity-language-server.lua]
// [!include ~/snippets/setup/neovim.lua]
```

LSP capabilities + enable:

```lua [.config/nvim/plugin/lsp.lua]
// [!include ~/snippets/setup/neovim-plugin-lsp.lua]
```

## File manager requirement

For `templateOnCreate`, rename import updates, and delete import updates to work, your file manager must send LSP file operation events:

- `workspace/willCreateFiles`
- `workspace/willRenameFiles`
- `workspace/willDeleteFiles`

If these events are not sent, the server cannot apply those file-operation edits.

Example (`oil.nvim`):

```lua [.config/nvim/lua/plugins/oil.lua]
// [!include ~/snippets/setup/neovim-oil.lua]
```

## Neovim note for rename flows

After file renames, if your editor leaves updated imports in modified buffers, run:

```vim
:wa
```

This writes all modified buffers so tools reading from disk (for example `forge`) see updated imports.

## Debugging

Neovim LSP logs are written to:

```text
~/.local/state/nvim/lsp.log
```

Clear logs:

```bash
> ~/.local/state/nvim/lsp.log
```

Tail logs in real time:

```bash
tail -f ~/.local/state/nvim/lsp.log
```

Enable LSP log levels from Neovim:

```vim
" info level
:lua vim.lsp.set_log_level("info")
" trace/debug level
:lua vim.lsp.set_log_level("trace")
```

## Lint options reference

Lint options (severity, rule IDs, `only`, `exclude`) are documented in [Setup Overview â†’ Lint values](/setup#lint-values).

## FAQ

### Renaming a `.sol` file doesn't update imports in Neovim

When you rename a file through a file explorer plugin (for example `oil.nvim`), the server should update import paths in other files. If this is not happening:

1. Verify workspace folders are correct.

```vim
:lua for _, c in ipairs(vim.lsp.get_clients()) do print(c.name, vim.inspect(c.workspace_folders)) end
```

You should see an absolute `file://` URI, not `file://.`.

2. Verify your file explorer sends `workspace/willRenameFiles`.

For `oil.nvim`, make sure LSP file methods are enabled:

```lua
require("oil").setup({
  lsp_file_methods = {
    enabled = true,
    timeout_ms = 1000,
    autosave_changes = "unmodified",
  },
})
```

3. Check the Neovim LSP log.

```bash
tail -f ~/.local/state/nvim/lsp.log
```

You should see `workspace/willRenameFiles` and then a server message with edit counts.

4. Save all modified buffers after rename.

```vim
:wa
```

`willRenameFiles` applies edits to buffers, but your editor may not auto-save all touched files to disk.
